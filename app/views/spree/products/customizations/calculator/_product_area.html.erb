<%= content_for :flexi_variants_body_js do %>

  <%= javascript_tag do %>
    function calculate_product_area_price(obj) {

      // right now, assuming width & height are interchangeable

      var fields = $.makeArray($(obj).parent().parent().find('input[type=text]'));

      if (fields.length != 2) {
        return 0;
      }

    var width = $(fields[0]).val();
    var height = $(fields[1]).val();
    if (<%= calculator.preferred_min_width%> > width || <%= calculator.preferred_max_width%> < width){
    $(".width_error").text("**width should be between " + <%= calculator.preferred_min_width%> + " and " + <%= calculator.preferred_max_width%>)
    $(".width_error").show(); }
    else {
    $(".width_error").hide(); }

    if (height > 0 && (<%= calculator.preferred_min_height%> > height || <%= calculator.preferred_max_height%> < height)){
    $(".height_error").text("**height should be between " + <%= calculator.preferred_min_height%> + " and " + <%= calculator.preferred_max_height%>)
    $(".height_error").show(); }
    else {
    $(".height_error").hide(); }

      var area = $(fields[0]).val() * $(fields[1]).val();

      // from http://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric

      if (isNaN(parseFloat(area)) || !isFinite(area)) {
        return 0;
      }

      var min_area=<%= calculator.preferred_min_pricing_area %>;

      if (min_area > area) {
        area = min_area;
      }

      var mult=<%= calculator.preferred_multiplier %>;

      return area * mult;
    }
  <% end %>
<% end %>
